#!/usr/bin/env bash

apt-get update
apt-get install -y nginx

# Configure Nginx to add the custom header
CONFIG_FILE="/etc/nginx/sites-available/default"
HEADER_LINE="add_header X-Served-By \$hostname;"

# Check if the header line already exists in the configuration file
if ! grep -q "$HEADER_LINE" "$CONFIG_FILE"; then
    # Insert the header line into the server block
    sed -i "/server {/a \ \ \ \ $HEADER_LINE" "$CONFIG_FILE"
fi

# Restart Nginx to apply changes
service nginx restart

